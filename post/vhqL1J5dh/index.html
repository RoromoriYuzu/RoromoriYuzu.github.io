
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>一开抓包工具APP就断网 | 路路森</title>
<meta name="description" content="生命不息，折腾不止">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://blog.diyworld.me/favicon.ico?v=1747968425405">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://blog.diyworld.me/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://blog.diyworld.me">
        <img class="avatar" src="https://blog.diyworld.me/images/avatar.png?v=1747968425405" alt="" width="32px" height="32px">
      </a>
      <a href="https://blog.diyworld.me">
        <h1 class="site-title">路路森</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="https://RoromoriYuzu.github.io/post/note" class="menu purple-link">
            记录
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">一开抓包工具APP就断网</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2022-07-22</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://blog.diyworld.me/tag/MLbsHODdf/">
                    抓包
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content" v-pre>
            <p><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E7%94%A8%E5%88%B0%E7%9A%84%E5%B7%A5%E5%85%B7">用到的工具</a></li>
<li><a href="#%E7%BB%99%E5%AE%89%E5%8D%93%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AE%89%E8%A3%85xposed%E6%A1%86%E6%9E%B6-%E6%96%B9%E6%B3%95%E5%A4%AA%E6%97%A7%E4%BA%86%E6%96%B0%E6%96%B9%E6%B3%95%E7%9C%8B%E4%B8%8B%E9%9D%A2">给安卓模拟器安装Xposed框架 （方法太旧了，新方法看下面）</a></li>
<li><a href="#%E7%BB%99%E5%AE%89%E5%8D%93%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AE%89%E8%A3%85magisk-%E5%92%8C-lsposed-%E6%A1%86%E6%9E%B6-2023-11-15-%E6%9B%B4%E6%96%B0">给安卓模拟器安装Magisk 和 LSPosed 框架 （2023-11-15 更新）</a></li>
<li><a href="#%E6%8A%93%E5%8C%85">抓包</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8vmos-%E6%8A%93%E5%8C%85">使用VMOS 抓包</a>
<ul>
<li><a href="#%E5%AE%89%E8%A3%85%E6%A8%A1%E5%9D%97">安装模块</a></li>
<li><a href="#%E5%AF%BC%E5%85%A5%E8%AF%81%E4%B9%A6">导入证书</a></li>
</ul>
</li>
<li><a href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8A%93%E5%8C%85">微信小程序抓包</a></li>
</ul>
</li>
<li><a href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%85%8D%E5%90%88clash%E6%8A%93%E5%8C%85">微信小程序配合Clash抓包</a></li>
</ul>
</li>
</ul>
</p>
<h2 id="用到的工具">用到的工具</h2>
<ul>
<li>Fiddler</li>
<li>雷电模拟器 或 其他模拟器 又或者是你的手机</li>
<li>Xposed</li>
<li>JustTrustMe<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> 或 TrustMeAlerady<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></li>
<li>工具包</li>
<li>Openssl</li>
</ul>
<hr>
<ul>
<li>VMOS</li>
<li>HttpCanary</li>
</ul>
<h2 id="给安卓模拟器安装xposed框架-方法太旧了新方法看下面">给安卓模拟器安装Xposed框架 （方法太旧了，新方法看下面）</h2>
<p>（已经有 Xposed 权限的可以忽略）<br>
确保模拟器已开启Root权限并且是 Android 7.1 64 位，下载工具包，里面有所用到的文件</p>
<p><a href="https://pan.baidu.com/s/1wBllwjoXlnZ3OuVFNXr3bg?pwd=hfr7">下载链接</a></p>
<ol>
<li>
<p>解压后安装里面的三个APP。</p>
</li>
<li>
<p>将 Xposed 文件夹放在模拟器的共享文件夹下。</p>
<ol>
<li>在模拟器中打开安装好文件管理器。</li>
<li>打开 <code>/sdcard/pictures</code> 目录里 <code>Xposed</code> 鼠标左键按住出现复制选项。</li>
<li>返回找到 <code>system</code> 文件夹 粘贴。</li>
<li>将 <code>Xposed</code> 文件夹复制到 <code>system</code> 目录。</li>
</ol>
</li>
<li>
<p>打开安装好的终端模拟器。</p>
<ol>
<li>输入 <code>su</code> 执行。</li>
<li>输入 <code>cd /system/xposed </code>执行。</li>
<li>输入 <code>sh memu-script.sh</code> 执行。</li>
</ol>
</li>
<li>
<p>命令执行完毕 直接重启模拟器 即可。</p>
</li>
<li>
<p>安装 TrustMeAlerady 然后在 Xposed 里勾选上。</p>
</li>
<li>
<p>重启。</p>
</li>
</ol>
<h2 id="给安卓模拟器安装magisk-和-lsposed-框架-2023-11-15-更新">给安卓模拟器安装Magisk 和 LSPosed 框架 （2023-11-15 更新）</h2>
<ol>
<li>安装雷电模拟器 <a href="https://www.123pan.com/s/A6cA-5GAJh">去广告绿色版</a>，使用 Android 9 系统。</li>
<li>下载安装 <a href="https://github.com/HuskyDG/magisk-files/releases">适用于模拟器的 Magisk</a> ，我使用的是 <code>1327b58c-delta(25201)(D)</code> 版本，这个版本有个Bug 点击日志会卡住，但较高版本移除了 MagiskHide 并且开启 Zygisk 后会无法开机。
<ol>
<li>在模拟器设置里开启 ROOT 权限和 System.vmdk 可写入</li>
<li>打开 Magisk Delta 如索取 ROOT 权限请给予，点击安装。如弹出访问设备上的文件权限申请请允许，完成后在新界面 <code>不要有操作</code>，关闭 Magisk Delta 并重新打开。</li>
<li>再次打开 Magisk Delta 后还是点击安装，然后点击下一步，在方式下出现三个选项，这里选择 <code>安装至系统分区</code>，如果没有出现三个选项请看第二步。</li>
<li>此时正常不出意外的话 Magisk Delta 就安装成功了。</li>
</ol>
</li>
<li>下载安装 [LSPosed模块] (https://github.com/LSPosed/LSPosed/releases)</li>
<li>之后安装 TrustMeAlerady 之类的插件就可以了。</li>
</ol>
<h2 id="抓包">抓包</h2>
<ol>
<li>查看你的 Fiddler 的代理端口。</li>
<li>在 CMD 里执行<code> ipconfig</code> 查看本机的 IP 地址。</li>
<li>在模拟器内 查看 wifi -&gt; 修改网络 -&gt; 代理 -&gt; 手动 -&gt; 填写前面的IP和端口。</li>
<li>在主机打开浏览器 输入IP和端口 点击 FiddlerRoot certificate 下载证书。</li>
<li>准备导入证书到模拟器的根目录</li>
<li>安装openssl（可选）  <a href="http://slproweb.com/products/Win32OpenSSL.html">下载地址</a>
<ol>
<li>使用openssl命令解析证书的hash值</li>
<li><code>openssl x509 -subject_hash_old -in .\FiddlerRoot.cer -inform der</code><br>
<img src="/post-images/1658477518577.png" width=50%><br>
拿到hash值：269953fb，好像证书的hash都是这个，所以可以省略这一步</li>
</ol>
</li>
<li>将刚刚导出到桌面的证书改成269953fb.0，0是后缀名</li>
<li>导入 269953fb.0 证书到手机设备<br>
和这里的步骤差不多<br>
<a href="#%E5%AF%BC%E5%85%A5%E8%AF%81%E4%B9%A6">导入证书</a></li>
</ol>
<p>接下来没有什么错误的话，应该可以正常抓包了。</p>
<hr>
<h3 id="使用vmos-抓包">使用VMOS 抓包</h3>
<p>工具包<br>
<a href="https://pan.baidu.com/s/1AMUdQAGao94VzFZ-fNUHZw?pwd=9bax">下载链接</a></p>
<h4 id="安装模块">安装模块</h4>
<p>VMOS 内有很多自带 Xposed 的 ROM  就不说怎么安装了。</p>
<ol>
<li>同样在 Xposed 里面安装上 TrustMeAlerady 模块。</li>
</ol>
<h4 id="导入证书">导入证书</h4>
<ol>
<li>打开 HttpCanay SSL证书设置选择导出根证书，类型System Trusted (.0)<br>
<code>导出的证书储存路径为：内部储存/HttpCanary/cert/</code></li>
<li>打开虚拟机 VMOS ，选择文件中转站—我要导入：RE管理器+目标APP+证书。</li>
<li>打开并赋予RE管理器root权限，刚刚导入的证书在VMOSfiletransferstatio目录下，将其复制到VMOS系统内：/system/etc/security/cacerts/目录下即可。</li>
<li>返回本机启动小黄鸟，目标应用-设置VMOS-开启抓包。</li>
</ol>
<h3 id="微信小程序抓包">微信小程序抓包</h3>
<p>（太旧，已失效，可以使用 HTTPDebugger 直接抓包）<br>
<s>因为微信有检测，不太能放在模拟器里，但 PC 端的微信没有 SSL 验证，可以直接抓包。<br>
如果 Fiddler 抓不到的话 <code>C:\Users\你的用户名\AppData\Roaming\Tencent\WeChat\XPlugin\Plugins\WMPFRuntime</code> 文件夹内的文件全部删除，重新打开微信就能解决。</s></p>
<h2 id="微信小程序配合clash抓包">微信小程序配合Clash抓包</h2>
<p>TUN模式开启，Windows的系统代理要关掉。</p>
<p>Clash for Windows 的 Proxies 选择 Rule</p>
<p>Clash 配置 （其中port是你的 Fiddler 的端口）</p>
<pre><code class="language-yaml">proxies:
  - name: Fiddler
    type: http
    server: 127.0.0.1
    port: 8888
proxy-groups:
  - name: Proxy
    proxies:
      - Fiddler
    type: select
rules:
  - PROCESS-NAME,Fiddler.exe,DIRECT
  - PROCESS-NAME,WeChatAppEx.exe,Fiddler
  - PROCESS-NAME,WeChat.exe,Fiddler
  - MATCH,DIRECT
</code></pre>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>https://github.com/Fuzion24/JustTrustMe <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>https://github.com/ViRb3/TrustMeAlready <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://blog.diyworld.me/post/ghsIrrZcd/">
              <h3 class="post-title">
                下一篇：Linux 笔记
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">生命不息，折腾不止</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://blog.diyworld.me/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: 'df0154d6a9f45f1e95f3',
        clientSecret: '72bdef4a1fb6001d84fb3f09c9e7c840c4887d68',
        repo: 'RoromoriYuzu.github.io',
        owner: 'RoromoriYuzu',
        admin: ['RoromoriYuzu'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
